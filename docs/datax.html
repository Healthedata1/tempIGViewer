<!-- template for the static html pages not generated by build e.g., index, guidance , toc -->

<!DOCTYPE HTML>

<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
   <meta charset="UTF-8"/>
  <title>DataExchangeForQualityMeasuresR4</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="DataExchangeForQualityMeasuresR4 Implemenation Guide" />
<meta name="author" content="HL7 International - Clinical Quality Information Work Group"/>
  <link href="fhir.css" rel="stylesheet"/>


   <!-- Bootstrap core CSS -->

   <!-- Latest compiled and minified CSS -->

  <link href="assets/css/bootstrap.css" rel="stylesheet"/>
  <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>
  <link href="assets/css/bootstrap-glyphicons.css" rel="stylesheet"/>

  <!-- Project extras -->
  <link href="assets/css/project.css" rel="stylesheet"/>
  <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
	<link href="assets/css/jquery-ui.css" rel="stylesheet"/>




  <!-- Favicons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
  <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
  <link rel="shortcut icon" href="assets/ico/favicon.png"/>


<body markdown="1">
<?xml version="1.0" encoding="UTF-8"?>
<div id="segment-header" class="segment">
  <!-- segment-header -->
  <div class="container"><!-- container -->

<!-- hl7 logo -->
    <a no-external="true" href="http://hl7.org/fhir">
      <img alt="FHIR Homepage" class="img-responsive logo" src="assets/images/fhir-logo-www.png"/>
    </a>
<!-- end hl7 logo -->


 <!-- org logo -->
             <!--
<a no-external="true" href="http://www.hl7.org">
<img height="50" alt="visit the hl7 website" width="42" src="assets/images/hl7-logo.png"/>
</a>


================THIS IS FOR THE PROJECT LOGO AND URL ===============
-->

<a no-external="true" href="http://www.hl7.org">
<img alt="visit our website" class="img-responsive project-logo" src="assets/images/org_logo.png"/>
</a>

  <!-- end org logo -->

  <div id="project-status" class="project-status"> <!-- ig title text -->
    
    <b>Data Exchange For Quality Measures R4 Implementation Guide</b>
    
    
    CI Build
    
</div><!-- end ig title text -->

  </div><!-- end container -->
  <div class="container">
    <!-- container -->
  </div>
</div>
<!-- /segment-header -->


<div id="segment-navbar" class="segment">
  <!-- segment-navbar -->
  <div id="stripe">
  </div>
  <div class="container">
    <!-- container -->
    <!-- HEADER CONTENT -->
    <nav class="navbar navbar-inverse">
      <div class="container">
        <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
          <span class="icon-bar">
          </span>
          <span class="icon-bar">
          </span>
          <span class="icon-bar">
          </span>
        </button>
        <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
        <div class="nav-collapse collapse navbar-inverse-collapse">

       <ul class="nav navbar-nav">
  <li>
    <a href="index.html">Home</a>
  </li>
  <li class="dropdown">
    <a href="#" data-toggle="dropdown" class="dropdown-toggle">Framework<b class="caret">
      </b> <!-- Da Vinci Individual Measures Use Cases -->
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="guidance.html">General Guidance</a>
      </li>
      <li>
        <a href="datax.html">Data Exchange</a>
      </li>
      <li>
        <a href="indv-reporting.html">Individual Reporting</a>
      </li>
      <li>
        <a href="summary-reporting.html">Summary Reporting</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a href="#" data-toggle="dropdown" class="dropdown-toggle">Example Use Cases<b class="caret">
      </b> <!-- Da Vinci Individual Measures Use Cases -->
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="mrp.html">Medication Reconciliation (MRP)</a>
      </li>
      <li>
        <a href="col.html">Colorectal Cancer Screening (COL)</a>
      </li>
      <li>
        <a href="vte1.html">Venous Thromboembolism Prophylaxis (VTE-1)</a>
      </li>
    </ul>
  </li>

  <li class="dropdown">
    <a href="#" data-toggle="dropdown" class="dropdown-toggle">FHIR Artifacts<b class="caret">
      </b>
    </a>
    <ul class="dropdown-menu">

      <!--
<li>
  <a href="operations.html">Operations</a>
</li>
-->

      <li>
        <a href="profiles.html">Profiles/Extensions</a>
      </li>
      <li>
        <a href="operations.html">Operations</a>
      </li>
      <!--
<li>
  <a href="terminology.html">Terminology</a>
</li>
-->
      <li>
        <a href="capstatements.html">CapabilityStatements</a>

      </li>
    </ul>
  </li>
  <!--
<li>
  <a href="security.html">Security</a>
</li>
-->
  <li>
    <a href="all-examples.html">Examples</a>
  </li>

  <li>
    <a href="downloads.html">Downloads</a>
  </li>
</ul>


      </div>
      <!-- /.nav-collapse -->
    </div>
    <!-- /.container -->
  </nav>
  <!-- /.navbar -->
  <!-- /HEADER CONTENT -->
</div>
<!-- /container -->
</div>
<!-- /segment-navbar -->


</div>  <!-- /container -->
</div>  <!-- /segment-breadcrumb -->


<div id="page-content-wrapper">  <!-- page content wrapper -->
  <div class="page-content">  <!--page content -->
    <div class="container">  <!-- container -->
      <div class="row">  <!-- row -->
       <div class="inner-wrapper"> <!-- inner-wrapper -->
         <div class="col-12">  <!--col -->
            <!-- content of page -->











<!-- ============BreadCrumb=============== -->

<nav class="breadcrumb">
  
    <a class="breadcrumb-item btn btn-link btn-sm" href="toc.html">TOC</a> 
</nav>


<!-- ============StatusBox=============== -->


<!--ReleaseHeader--><p id="publish-box">Data Exchange For Quality Measures R4 - Local Development build (v1.1.0). See the <a href="http://hl7.org/fhir/us/davinci-deqm/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
<!-- 
This is the {% if {{site.build}} == "ci" %}
    Continuous Integration Build
   {% else %}
    (release {{site.data.fhir.ig.version}})
  {% endif %}
  {% if {{site.build}} == "ballot" %} {{site.ballot}} Ballot {% endif %}
  of the {{site.data.fhir.igName}} Implementation Guide,  based on <a href="{{ site.data.fhir.path }}index.html">FHIR Version {{ site.data.fhir.version }}</a>.  See the <a href="{{ site.historypath }}">Directory of published versions.</a>
 -->


<!-- ============CONTENT CONTENT=============== -->


<h2>Data Exchange Interactions</h2>

<!-- page source: datax.md  -->




<!-- TOC  the css styling for this is \pages\assets\css\project.css under 'markdown-toc'-->

<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#profiles" id="markdown-toc-profiles">Profiles</a></li>
  <li><a href="#data-exchange" id="markdown-toc-data-exchange">Data Exchange</a>    <ul>
      <li><a href="#submit-data" id="markdown-toc-submit-data">Submit Data operation</a></li>
      <li><a href="#collect-data" id="markdown-toc-collect-data">Collect Data operation</a></li>
      <li><a href="#submit-data-and-collect-data-for-multiple-patients" id="markdown-toc-submit-data-and-collect-data-for-multiple-patients">Submit Data and Collect Data for Multiple Patients</a></li>
    </ul>
  </li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>Clinical Quality Measures (CQMs) are a common tool used throughout healthcare to help evaluate and understand the impact and quality of the care being provided to an individual or population. The intent of “data-of-interest” is the source data needed to calculate a quality measure, as specified by the data requirements of the measure. For example, for a colorectal cancer screening measure, the data-of-interest is the set of conditions, procedures, and observations related to determining whether a patient is in the initial population, denominator, and numerator of the quality measure. To effectively evaluate quality measures in such an environment requires timely exchange of the relevant data.</p>

<p>Transactions between Consumers (organizations that want to evaluate quality measures) and Producers (organizations that deliver care to patients) are triggered by use case specific clinical or administrative events such as the completion of a Medication Reconciliation or a request from a Payer for the attestation information. Note that although triggering is implementation specific and out of scope for this IG,  there are a variety of potential triggering points for reporting events within clinical systems.  These include:</p>

<ul>
  <li><a href="http://www.openinfobutton.org/">Infobutton</a> event listing</li>
  <li><a href="http://www.hl7.org/fhir/us/ecr/history.cfml">eCR</a> Event Types</li>
  <li><a href="https://cds-hooks.org/">CDS Hooks</a> Hook definitions</li>
  <li><a href="http://www.hl7.org/fhir/uv/cpg/history.cfml">CPG-on-FHIR</a> common processes</li>
</ul>

<p>and there will be a need to convey triggering information in a computable way to EHRs and other clinical systems.</p>

<p>This Implementation Guide (IG) describes three methods of exchanging data quality information using a set of <a href="operations.html" title="Extended Operations on the RESTful API">FHIR operations</a> that provide the framework to exchange CQM data:</p>

<ol>
  <li>CQM data may be submitted to the Consumer by the Producer using the <a href="#submit-data">Submit Data operation</a></li>
  <li>CQM data may be requested from the Producer by the Consumer using the <a href="#collect-data">Collect Data operation</a></li>
</ol>

<p class="stu-note">This project recognizes the impact of the <a href="https://argonautwiki.hl7.org/Argonaut_2019_Projects#Clinical_Data_Subscriptions">Argonaut Clinical Data Subscriptions</a> project which is working on event based subscriptions and major revisions to the Subscription resource for FHIR R5. In a future version this guide, a subscription based exchange <!-- in which the Consumer may subscribe to a Producer's Subscription service to be notified when the CQM data is available --> is planned and will align with the outcomes of the Argonaut project.</p>

<p>FHIR operations allow the implementation to be viewed as a ‘black box’ free to decide how to satisfy the query - “give me the data of interest for a measure” - without requiring generic FHIR search functionality.</p>

<h2 id="profiles">Profiles</h2>

<p>The following resources are used in all data exchange transactions:</p>

<table>
  <thead>
    <tr>
      <th>Resource Type</th>
      <th>Profile Name</th>
      <th>Link to Profile</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Library</td>
      <td>CQFM Library Profile</td>
      <td><a href="http://build.fhir.org/ig/HL7/cqf-measures/StructureDefinition-library-cqfm.html">CQFM Library</a></td>
    </tr>
    <tr>
      <td>Measure</td>
      <td>CQFM Measure Profile</td>
      <td><a href="http://build.fhir.org/ig/HL7/cqf-measures/StructureDefinition-measure-cqfm.html">CQFM Measure</a></td>
    </tr>
    <tr>
      <td>MeasureReport</td>
      <td>DEQM Data Exchange MeasureReport Profile</td>
      <td><a href="StructureDefinition-datax-measurereport-deqm.html">DEQM Data Exchange MeasureReport Profile</a></td>
    </tr>
    <tr>
      <td>Organization</td>
      <td>DEQM Organization Profile</td>
      <td><a href="StructureDefinition-organization-deqm.html">DEQM Organization</a></td>
    </tr>
    <tr>
      <td>Patient</td>
      <td>QI Core Patient Profile</td>
      <td><a href="http://build.fhir.org/ig/HL7/fhir-qi-core/StructureDefinition-qicore-patient.html">QI Core Patient</a></td>
    </tr>
  </tbody>
</table>

<p>Depending on the specific Measure, various DEQM and QI Core Profiles are also used in addition to the profiles listed above</p>

<h3 class="no_toc" id="graph-of-deqm-resources">Graph of DEQM Resources</h3>

<p>The DEQM resources form a network through their relationships with each other - either through a direct reference to another resource or through a chain of intermediate references. These groups of resources are referred to as resources graphs.  The DEQM data exchange resource graph is shown in Figure 2-1:</p>

<!-- all this Bootstrap html for getting an narrow image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/measure-resource-graph.svg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong>Figure 2-1 DEQM Resource Graph</strong></figcaption>
  <img src="assets/images/measure-resource-graph.svg" class="figure-img img-responsive img-rounded center-block" alt="measure-resource-graph.svg" />
</figure>

<p></p>
</div>

<p><br /></p>

<h2 id="data-exchange">Data Exchange</h2>

<h3 id="submit-data">Submit Data operation</h3>

<p>The <em>Submit Data</em> operation allows a Producer to submit data-of-interest for a particular quality measure within the specified time window when the data is ready. There is no expectation that the data submitted represents all the data required to evaluate the quality measure, only that the data is known to be relevant to the quality measure, based on the data requirements for the measure. Note that resources included in a <em>Submit-Data</em> bundle <strong>SHOULD</strong> be self-contained (in other words, should include all referenced resources in the data), unless the exchange is understood by both parties to be incremental. For example, if an Encounter references a Location, that Location is expected to be included in the bundle, unless the exchange is understood to be incremental and the sending system knows that it has already sent that particular Location as part of a previous submit.</p>

<p>To discover what data (i.e. resources) are relevant in the <em>Submit Data</em> payload for a particular measure, a <em>Data Requirements</em> operation <strong>MAY</strong> be invoked on a Consumer’s measure instance endpoint.  The response to this operation provides a list of Data Requirements which detail what data needs to be submitted in order for the Consumer to evaluate the measure.  Cases were reporting requirements are not known, the data would not be submitted until the correct measure and version is known.</p>

<!-- all this Bootstrap html for getting an narrow image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/mrp-wf-overview.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong>Figure 2-2 Submit Data Steps</strong></figcaption>
  <img src="assets/images/mrp-wf-overview.jpg" class="figure-img img-responsive img-rounded center-block" alt="mrp-wf-overview.jpg" />
</figure>

<p></p>
</div>

<h4 class="no_toc" id="gather-data-requirements-from-consumer">Gather Data Requirements from Consumer</h4>

<p>In this step, the Producer queries a common knowledge store for profiles needed for reporting a given measure and how the sending of those data should be initiated. Common data profiles have been developed through a multi-stakeholder consensus-based development process and will be made available from the common site. To support the <em>Submit Data</em> operation, an implementation needs to know specifically what data are required to provide as the payload for the operation. This can be done manually by reviewing the measure definition to determine what data needs to be submitted and it is automated by using the <em>Data Requirements</em> operation. <em>These profiles are subsequently referenced in the <code class="highlighter-rouge">MeasureReport.evaluatedResources</code> element</em> when submitting the measure data to the Consumer.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/data-requirement.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong>Figure 2-3 Data Requirements Operation</strong></figcaption>
  <img src="assets/images/data-requirement.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="data-requirement.jpg" />
</figure>

<p></p>
</div>

<h5 class="no_toc" id="apis">APIs</h5>

<p>In addition to the resources listed above, the following artifacts are used in this transaction:</p>

<ol>
  <li>Data Requirements: <a href="http://hl7.org/fhir/R4/measure-operations.html#data-requirements" title="The data-requirements operation aggregates and returns the parameters and data requirements for the measure and all its dependencies as a single module definition">$data-requirements</a> operation</li>
</ol>

<h5 class="no_toc" id="usage">Usage</h5>

<p>The required data for each Measure is discovered by invoking the <em>Data Requirements</em> operation on the Consumer’s <code class="highlighter-rouge">Measure/[measure-id]</code> endpoint.  Using either the <code class="highlighter-rouge">GET</code> or <code class="highlighter-rouge">POST</code> Syntax, the operation can be invoked as follows:</p>

<p><code class="highlighter-rouge">GET|[base]/Measure/[measure-id]/$data-requirements?periodStart={periodStart}&amp;periodEnd={periodEnd}</code></p>

<p><code class="highlighter-rouge">POST|[base]/Measure/[measure-id]/$data-requirements</code></p>

<p>Note the use of the <code class="highlighter-rouge">periodStart</code> and <code class="highlighter-rouge">periodEnd</code> parameters supports description of data requirements that filter based on the reporting period. For example, a measure may require data for a certain procedure within the last three years, and the data requirements returned will reflect that period.</p>

<p>
  <button class="btn btn-info btn-lg" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#data-requirements-example" aria-expanded="false" aria-controls="collapseExample">
    Click Here To See Example Data Requirements operation
  </button>
</p>

<div class="collapse" id="data-requirements-example">
  <div class="card card-body">
      <h3 class="no_toc" id="example">Example</h3>

<p><strong>Scenario</strong></p>

<p>Provider X acting in the role of the Producer requests data requirements for the MRP measure from Payer Z which is acting in the role of Consumer.  A Library resource containing the required resources for MRP attestation returned on successful evaluation.</p>

<p><strong>Request using <code class="highlighter-rouge">GET</code></strong></p>

<p><code class="highlighter-rouge">GET [base]/Measure/measure-mrp/$data-requirements?periodStart=2018&amp;periodEnd=2018</code></p>

<p><strong>Request using <code class="highlighter-rouge">POST</code></strong></p>

<p><code class="highlighter-rouge">POST [base]/Measure/measure-mrp/$data-requirements</code></p>

<p><strong>Request body</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"periodStart",
         "valueDate":"2018"
      },
      {
         "name":"periodEnd",
         "valueDate":"2018"
      }
    ]
 }
</code></pre></div></div>

<p><strong>Response</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
[other headers]
</code></pre></div></div>

<p><strong>Response body</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
   "resourceType":"Library",
   "status":"active",
   "type":{
      "coding":[
         {
            "code":"module-definition"
         }
      ]
   },
   "relatedArtifact":[
      {
         "type":"depends-on",
         "resource":{
            "reference":"http://hl7.org/fhir/us/hedis/Library/library-mrp-logic"
         }
      }
   ],
   "dataRequirement":[
      {
         "type":"MeasureReport",
         "profile":[
            "http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/measurereport-deqm"
         ]
      },
      {
         "type":"Patient",
         "profile":[
            "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-patient"
         ]
      },
      {
         "type":"Encounter",
         "profile":[
            "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter"
         ]
      },
      {
         "type":"Location",
         "profile":[
            "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-location"
         ]
      },
      {
         "type":"Task",
         "profile":[
            "http://ncqa.org/fhir/us/hedis/StructureDefinition/hedis-task"
         ]
      },
      {
         "type":"Organization",
         "profile":[
            "http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/organization-deqm"
         ]
      },
      {
         "type":"Practitioner",
         "profile":[
            "http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/practitioner-deqm"
         ]
      }
   ]
}
</code></pre></div></div>

  </div>
</div>

<h4 class="no_toc" id="submit-data-operation">Submit Data Operation</h4>

<p>Once the Producer understands the data requirements, they will use the <em>Submit Data</em> operation to submit a MeasureReport and the referenced resources as discovered by the <em>Data Requirements</em> operation to the Consumer. There is no expectation that the submitted data represents all the data-of-interest, only that all the data submitted is relevant to the calculation of the measure for a particular subject or population. The Consumer simply accepts the submitted data and there is no expectation that the Consumer will actually evaluate the quality measure in response to every Submit Data. In addition, the Submit Data operation does not provide for analytics or feedback on the submitted data.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/submit-data.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong>Figure 2-4 Submit data Operation</strong></figcaption>
  <img src="assets/images/submit-data.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="submit-data.jpg" />
</figure>

<p></p>
</div>

<h5 class="no_toc" id="apis-1">APIs</h5>

<p>In addition to the resources listed above, the following artifacts are used in this transaction:</p>

<ol>
  <li>Submit Data operation: <a href="OperationDefinition-submit-data.html" title="The effect of invoking this operation is to gather the data required to perform an evaluation of the measure.">$submit-data</a></li>
  <li>Various DEQM and QI Core Profiles depending on the specific Measure</li>
</ol>

<h5 class="no_toc" id="usage-1">Usage</h5>

<p>Using the <code class="highlighter-rouge">POST</code> Syntax, the operation can be invoked by the Producer:</p>

<p><code class="highlighter-rouge">POST|[base]/Measure/[measure-id]/$submit-data</code></p>

<p>
  <button class="btn btn-info btn-lg" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#submit-data-example" aria-expanded="false" aria-controls="collapseExample">
    Click Here To See Example Submit Data Operation (edited for brevity)
  </button>
</p>

<div class="collapse" id="submit-data-example">
  <div class="card card-body">
      <h3 class="no_toc" id="examples">Examples</h3>

<p><strong>Scenario:</strong></p>

<p>Provider X acting in the role of Producer submits MRP data for Patient Y to Payer Z who is acting in the role of Consumer.  The body of the request is a Parameters resource containing the required profiles for MRP attestation using Task as the resource used to evaluate the measure.  An HTTP Status success code is returned on successful submission.</p>

<p><strong>Request using <code class="highlighter-rouge">POST</code></strong></p>

<p><code class="highlighter-rouge">POST [base]/Measure/measure-mrp/$submit-data</code></p>

<p><strong>Request body</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"measurereport",
         "resource":"{"resourceType": "MeasureReport",
         ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Task",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Patient",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Location",
          ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Practitioner",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Organization",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Coverage",
        ...}
      },

    ]
 }
</code></pre></div></div>

<p><strong>Response</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
[other headers]
</code></pre></div></div>

  </div>
</div>

<p>For a complete un-edited example see the <a href="mrp.html#data-exchange-using-the-submit-data-operation">MRP Submit Data Operation</a> example.</p>

<h3 id="collect-data">Collect Data operation</h3>

<p>In this scenario, the Consumer initiates a <em>Collect Data</em> operation to gather any available CQM data for a particular measure from the Producer.  In response to the operation, the Producer returns a MeasureReport containing data relevant to the Measure. It is assumed that the Producer knows the data requirements for the measure. As with the Submit Data operation, there is no expectation that this MeasureReport contains all the data required to evaluate the quality measure, nor is the measure score expected to be provided.</p>

<!-- *****removed based on GF#21737*********
As with the Submit Data case above, discovery of what CQM data (i.e. resources) are required is done through the *Data Requirements* operation on a Consumer's measure endpoint and the returned resources and profiles are referenced in the `MeasureReport.evaluatedResources` element.
-->

<!-- all this Bootstrap html for getting an narrow image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/collect-data-steps.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong>Figure 2-5 Collect Data Steps</strong></figcaption>
  <img src="assets/images/collect-data-steps.jpg" class="figure-img img-responsive img-rounded center-block" alt="collect-data-steps.jpg" />
</figure>

<p></p>
</div>

<h4 class="no_toc" id="collect-data-operation">Collect Data Operation</h4>

<p>The Consumer uses a Collect Data operation to request any available relevant data for the evaluation of a particular measure from a Producer. This would typically be done on a periodic basis to support incremental collection of quality data. The <code class="highlighter-rouge">lastReceivedOn</code> parameter can be used to indicate when the last Collect Data operation was performed, allowing the Producer to limit the response to only data that has been entered or changed since the last received on date.</p>

<p>Note that implementing this scenario requires that the Producer system understand the data requirements for the measure in order to provide the data. As with the Submit Data operation, the implementation can either manually determine the relevant data using the measure definition, or the implementation can use the <em>Data Requirements</em> operation to determine relevant data.</p>

<!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

<!-- file:///assets/images/collect-data.jpg -->

<div>
<figure class="figure">
<figcaption class="figure-caption"><strong>Figure 2-6 Collect data Operation</strong></figcaption>
  <img src="assets/images/collect-data.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="collect-data.jpg" />
</figure>

<p></p>
</div>

<h4 class="no_toc" id="apis-2">APIs</h4>

<p>In addition to the resources listed above, the following artifacts are used in this transaction:</p>

<ol>
  <li>Collect Data operation:<a href="OperationDefinition-collect-data.html" title="The effect of invoking this operation is to gather the data required to perform an evaluation of the measure.">$collect-data</a></li>
  <li>Various DEQM and QI Core Profiles depending on the specific Measure</li>
</ol>

<h4 class="no_toc" id="usage-2">Usage</h4>

<p><strong>Collect Data:</strong></p>

<p>Using either the <code class="highlighter-rouge">GET</code> or <code class="highlighter-rouge">POST</code> Syntax, the operation can be invoked by the Consumer:</p>

<p><code class="highlighter-rouge">GET|[base]/Measure/[measure-id]/$collect-data&amp;[parameters]</code></p>

<p><code class="highlighter-rouge">POST|[base]/Measure/[measure-id]/$collect-data</code></p>

<p>
  <button class="btn btn-info btn-lg" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#collect-data-example" aria-expanded="false" aria-controls="collapseExample">
    Click Here To See Example Collect Data operation
  </button>
</p>

<div class="collapse" id="collect-data-example">
  <div class="card card-body">
      <h3 id="examples">Examples</h3>

<p><strong>Scenario:</strong></p>

<p>Payer Z acting in the role of the Consumer collect Patient Z’s MRP data from Provider X which is acting in role of the Producer</p>

<p><strong>Request using GET Syntax</strong></p>

<p><code class="highlighter-rouge">GET [base]/MeasureReport/measure-mrp/$collect-data?patient=Patient/patient-z&amp;provider=Practitioner/provider-x&amp;periodStart=2018-06-19</code></p>

<p><strong>Request using POST Syntax</strong></p>

<p><code class="highlighter-rouge">POST [base]/MeasureReport/measure-mrp/$collect-data</code></p>

<p><strong>Request body</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"patient",
         "valueUri":"Patient/patient-z"
      },
      {
         "name":"practitioner",
         "valueUri":"Practitioner/provider-x"
      },
      {
         "name":"periodStart",
         "valueDate":"Practitioner/2018-06-19"
       }
    ]
 }
</code></pre></div></div>

<p><strong>Response</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
[other headers]
</code></pre></div></div>

<p><strong>Response body</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"measurereport",
         "resource":"{"resourceType": "MeasureReport",
         ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Task",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Patient",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Location",
          ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Practitioner",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Organization",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Encounter",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Coverage",
        ...}
      },

    ]
 }
</code></pre></div></div>

  </div>
</div>

<p>For a complete un-edited example see the <a href="col.html#data-exchange-using-the-collect-data-operation">COL Collect Data Operation</a> example.</p>

<h3 id="submit-data-and-collect-data-for-multiple-patients">Submit Data and Collect Data for Multiple Patients</h3>

<p>The <a href="http://hl7.org/fhir/R4/http.html#transaction">transaction</a> bundle processing as defined by FHIR specification is used for transacting multiple Submit Data and Collect Data operations for multiple patients in a single interaction.</p>

<ul>
  <li>The fullUrl refers to the <code class="highlighter-rouge">#submit-data</code> or <code class="highlighter-rouge">#collect-data</code> operation endpoint.</li>
  <li>The request method id <code class="highlighter-rouge">POST</code></li>
  <li>Follows the <a href="http://hl7.org/fhir/R4/references.html#contained">following rules</a> for referencing referencing across the bundle entries if the resources are nested inside parameters and/or contained within a parameter:
    <ul>
      <li>“When resolving references, references are resolved by looking through the ‘container’ resource - the one that contains the other resources. Since there are no nested contained resources, there is only one container resource.”</li>
      <li>“References to contained resources are never resolved outside the container resource. Specifically, resolution stops at the elements Bundle.entry.resource and Parameters.parameter.resource, but not at DomainResource.contained.”</li>
    </ul>
  </li>
</ul>

<p><strong>The transaction bundle contains an entry for each patient and as illustrated in the following examples:</strong></p>

<p>Submit Data Transaction Bundle</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST|[base]

{
  "resourceType": "Bundle",
  "type": "transaction",
  "entry": [
    {
      "fullUrl": [base]/Measure/[measure-id]/$submit-data
      "resource": {
        "resourceType": "Parameters",
        "parameter": [
          {
            "name": "measurereport",
            "resource": {
              "resourceType": "MeasureReport",
              "contained": [  ( or simply listing the other named parameters)
              ...
          ]
        },
        "request": {
          "method": "POST"
            }
            ....
</code></pre></div></div>

<p>Submit Data Transaction Bundle</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST|[base]

{
  "resourceType": "Bundle",
  "type": "transaction",
  "entry": [
    {
      "fullUrl": [base]/Measure/[measure-id]/$collect-data
      "resource": {
        "resourceType": "Parameters",
        "parameter": [
          {
            "name": "measurereport",
            "resource": {
              "resourceType": "MeasureReport",
              "contained": [  ( or simply listing the other named parameters)
              ...
          ]
        },
        "request": {
          "method": "POST"
            }
            ....
</code></pre></div></div>

<!-- ************************************************************
KEEP and edit to align with the Updated Argonaut Subscription Model
 ******************************************************************
### Subscriptions
{: #pub-sub}

FHIR Subscriptions allow for a Producer to notify the Consumer whenever new CQM data is available.  Effectively, the Consumer subscribes to the Producer's system using the Measure as the criteria. It is a short-hand for subscribing to all the data-of-interest (as defined by the data requirements) for the CQM, but using the Measure as the subscription point allows the implementation to determine the most efficient approach to notification. For example, notifications can be batched on a periodic basis, or they can be performed along transactional boundaries within the implementing system.

The Consumer uses the *Collect Data* operation described above to request the relevant data after it is notified.

{% include img.html  img="subscribe-data-steps.jpg"  caption ="Figure 2-7 Subscription Steps"%}

#### Subscribe for Measure Data
{:.no_toc}

The Consumer must first subscribe to the Producer for a notification for a particular measure.  The Consumer may subsequently unsubscribe to a measure subscription.

{% include img-narrow.html img="subscribe-data.jpg" caption="Figure 2-8 Subscription Service" %}

##### APIs
{:.no_toc}

The following artifacts are used in the subscription transaction:

1. DEQM Subscription Profile [DEQM Subscription] or [DEQM Subscription (R4)]
1. [DEQM Measure Subscription Extension]

##### Usage
{:.no_toc}

To subscribe for measure notifications, The Consumer SHALL use the standard FHIR [Subscription] API as follows:

`POST [base]/Subscription`

To unsubscribe:

`Delete [base]/Subscription/[id]`

{% include examplebutton.html example="subscribe-measure-example" b_title = "Click Here To See Example Subscription Transaction" %}

#### Get Data Requirements
{:.no_toc}

The DEQM Subscription Profile allows the subscriber to send a *CQFM Measure instance id*.  By invoking the $data-requirements operation (see above) on a subscriber’s Measure instance endpoint, the server can discover what data is needed to calculate by a subscriber for particular measure.  This information is necessary to correctly trigger a notification when the requisite data is available.

#### Measure Notifications
{:.no_toc}

The Producer notifies the Consumer when measure data is available. Exactly, how this notification is triggered is out of scope for this guide.  Note that  several architectures to implement the subscription notifications such as "point to point" notification or using a “feed handler” as an intermediary system are available.

{% include img-narrow.html img="measure-notifications.jpg" caption="Figure 2-9 Measure Notifications" %}

##### Usage
{:.no_toc}

 The standard FHIR Subscription API describes the REST Hook channel as follows:

`POST [app notification endpoint]`

{% include examplebutton.html example="measure-notification-example" b_title = "Click Here To See Example Subscription Notification" %}

##### Collect Data Operation
{:.no_toc}

Upon notification, the Consumer uses the *Collect Data* operation to request the CQM data from the notifying Producer.  This operation is discussed in the section above.
-->

<p><br /></p>



  <!-- ==============END CONTENT END CONTENT=================== -->

</div>  <!-- col -->
</div>  <!-- /inner-wrapper -->
</div>  <!-- /row -->
</div>  <!-- /container -->
</div>  <!-- /page content -->
</div>  <!-- /page content wrapper -->



</div>

    </div>  <!-- /inner-wrapper -->
            </div>  <!-- /row -->
        </div>  <!-- /container -->

    </div>  <!-- /segment-content -->

<!-- back to top arrow -->

<a id="back-to-top" href="#" class="btn btn-info btn-lg back-to-top" role="button" title="Click to return on the top page" data-toggle="tooltip" data-placement="left"><span class="glyphicon glyphicon-chevron-up"></span></a>


<!-- end back to top arrow -->

<div id="segment-footer" class="segment"  igtool="footer">  <!-- segment-footer -->
  <div class="container">  <!-- container -->
   <div class="inner-wrapper">
    <p>
     © 2019<!--  does not exist yet --> <a href="http://www.hl7.org/Special/committees/cqi/index.cfm">HL7 International - Clinical Quality Information Work Group</a>. hl7.fhir.us.davinci-deqm#1.1.0 based on <a style="color: #81BEF7" href="http://hl7.org/fhir/R4/index.html">FHIR 4.0.0</a><br/>created <span href="#" data-toggle="tooltip" data-placement="top" title="Mon, Oct 21, 2019 17:55-0700">2019-10-21</span>.
      Links: <a style="color: #81BEF7" href="toc.html">Table of Contents</a>
      | <a style="color: #81BEF7" href="qa.html">QA Report</a>
      | <a style="color: #81BEF7" href="http://hl7.org/fhir/us/davinci-deqm/history.cfml">Version History</a>
      | <a style="color: #81BEF7" rel="license" href="http://hl7.org/fhir/R4/license.html"><img style="border-style: none;" alt="CC0" src="cc0.png"/></a>
      | <a style="color: #81BEF7" href="http://hl7.org/fhir-issues" target="_blank">Propose a change</a>
        </p>
   </div>  <!-- /inner-wrapper -->
  </div>  <!-- /container -->
 </div>  <!-- /segment-footer -->
  <!-- disqus thread -->
  <!-- disqus -->
  <!-- end disqus -->

 <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
  <div class="container">  <!-- container -->
  </div>  <!-- /container -->
 </div>  <!-- /segment-post-footer -->

 <!-- JS and analytics only. -->
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./assets/js/jquery.min.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
<script src="./assets/js/bootstrap.min.js"> </script>
<script src="./assets/js/respond.min.js"> </script>
<script src="./assets/js/anchor.min.js"> </script>
<script src="./assets/js/fhir.js"> </script>


<script src="./assets/js/topofpage.js"> </script>




<script src="assets/js/clipboard.min.js"> </script>

<script>
  // Tooltip

  $('#copy-button').tooltip({
    trigger: 'click',
    placement: 'bottom'
  });

  function setTooltip(message) {
    $('#copy-button').tooltip('hide')
      .attr('data-original-title', message)
      .tooltip('show');
  }

  function hideTooltip() {
    setTimeout(function() {
      $('#copy-button').tooltip('hide');
    }, 1000);
  }

  // Clipboard

  var clipboard = new ClipboardJS('#copy-button');

  clipboard.on('success', function(e) {
    setTooltip('Copied!');
    hideTooltip();
  });

  clipboard.on('error', function(e) {
    setTooltip('Failed!');
    hideTooltip();
  });

</script>



<!-- Analytics Below
================================================== -->

<!-- add anchors before the closing body tag -->
<script>
anchors.add()

$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
});
</script>

</body>
</html>

